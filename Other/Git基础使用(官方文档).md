## Git基础使用(官方文档)

参考资料为git官方文档

> https://git-scm.com/book/en/v2

### Git简介

​	关于Git的一些基本定义,Git作用和发展历史等

###### Git解决的问题

- 版本控制
  - 对项目状态备份以方便回滚到历史状态
- 多人团队协作开发
  - 有两种版本版本控制思路,一种是集中式版本控制如SVN,另一种是分布式版本控制如Git
  - 两种方式都可以实现多人对同一项目开发时对文件修改的管理,可以对团队中提交的修改进行多种管理,并具有版本控制功能

###### Git是什么

​	Git是一种分布式版本控制系统,有以下特点

- 记录项目每个状态的快照
  - 是Git和其他VCS的区别,即对待数据方式不同
  - 传统方法是记录版本间的区别(Delta-based),而Git能够完整的记录版本中所有文件并制成快照
  - Git以快照流的方式对待项目数据,以时间线为坐标创建了连续的快照流完整记录项目变化情况
- 本地执行
  - 对于同一个项目,每个用户电脑里都有完整版本库,所有操作都在本地版本库中完成后再连接网络上传,因此在文件编辑阶段比SVN可靠和迅速
- 保证完整性
  - 所有数据存储前需要计算校验和,对文件内容进行散列得到40个16进制字符串(SHA-1哈希值),可以保证数据完整性
- 只添加数据
  - SVN会对数据进行删除,但Git中不会从数据库中删除数据,而是提交不包含要删除文件的快照
  - 保证了文件的安全,不会出现提交删除数据时出错从而丢失文件的问题
- 三种状态
  - Git托管文件会处于三种状态中一种
    - 已提交(commited)
    - 已修改(modified)
    - 已暂存(staged)
  - 对应Git项目也有三个阶段
    - 工作区workingDirectory
      - 存放从版本库中某个版本提取出来内容,供修改使用
    - 暂存区stagingArea
    - Git目录(版本库)GitDirectory
      - 保存项目元数据和对象数据库,是最重要部分
  - Git工作流程
    - 工作区中修改文件
    - 暂存更改以待提交,会将更改部分添加到暂存区
    - 提交更新,找到暂存区文件并将快照保存到Git目录

###### Git初始化

Git使用前需要配置一些信息

- 用户信息

  - 用户名

    ```
    git config --global user.name "username"
    ```

  - email

    ```
    git config --global user.email email@email.com
    ```

- 检查配置信息

  ```
  git config --list
  ```



### Git基础

包括Git各种基本指令,如创建版本库,跟踪文件,暂存和提交修改和相关的基础知识

#### 获取Git仓库

​	两种方式

- 初始化本地尚未进行版本控制的目录
- 从其他服务器克隆一个已存在的Git仓库

###### 在已存在目录中初始化仓库

- git init
  - 执行后会创建.git子目录,该目录中含有初始化Git仓库的必要文件
- 跟踪文件git add
  - git add添加要跟踪文件到暂存区
- 提交修改
  - git commit -m 'initial project version'
  - 将暂存区中修改提交到版本库中

###### 克隆现有仓库

- git clone <url> <repositoryName>
  - 会从url拉取每个文件和每个版本
  - repositoryName可选,如果没有该选项会以项目名为目录名

#### 记录每次更新到仓库

一个真实项目的Git仓库会从仓库中检出所有文件的工作副本,开发时对这些工作副本进行修改,到一定阶段时会将这些修改提交到仓库

​	工作目录下的文件有两种状态:

- 未跟踪
  - 不存在于上次快照和缓存区的文件
- 已跟踪
  - 被纳入了版本控制的文件,在上次快照中可以找到文件记录
  - 状态可以时未修改,已修改和已暂存

![工作目录下文件状态变化](https://git-scm.com/book/en/v2/images/lifecycle.png)

###### 检查当前文件状态

- git status
  - 会检测文件的跟踪和修改情况

###### 跟踪新文件

- git add <filename><repositoryName>
  - 会将指定的文件添加到暂存区中,开始跟踪

###### 暂存已修改文件

- git add
  - add指令是用于将内容精确地添加到下一次提交中
  - 同样可以用在跟踪新文件,将已跟踪文件放到暂存区,合并时将冲突文件标记为已解决
  - add指令添加的文件被修改后,需要重新执行add添加暂存
    - add指令只会暂存执行时版本,暂存文件被修改时,该文件会同时存在于暂存区和非暂存区

###### 忽略文件

对于不需要纳入版本控制的文件,需要创建.gitignore文件列出要忽略文件的模式

- .gitignore格式规范
  - 空行和#开头行会被Git忽略
  - 基本使用glob模式匹配,也就是简化的正则表达式

###### 查看已暂存和未暂存修改

- git diff
  - 和git status类似,但是会列出文本修改的内容比对
  - 查看的是未暂存修改
- git diff --staged
  - 查看已暂存修改

###### 提交更新

- git commit
  - 会将暂存区中的修改进行提交
  - 默认会弹出文本编辑器输入提交说明
  - 提交后会得到提交的分支和SHA-1校验和
  - 每次提交都是对项目做一次快照,将来可以回到该状态或进行比较

###### 跳过使用暂存区

- git commit -a
  - 跳过使用暂存区,自动将跟踪过的文件全部提交(无法提交未跟踪文件)

###### 移除文件

Git中移除文件需要将文件从暂存区中移除

- git rm
  - 会从工作目录和暂存区中移除文件,不再跟踪该文件
  - 和简单的从工作目录中手动删除文件不同,手动删除的文件仍然会被记录为一种修改

###### 移动文件

Git中需要使用git mv指令来达到重命名操作

- git mv file_from file_to
  - 相当于执行了git rm file_from和git add file_to

#### 查看提交历史

​	git log指令可以查看项目的提交历史,这个指令有几个可选参数

- -p
  - 查看提交引入的差异
- -<number>
  - 查看最近的number条历史记录

#### 远程仓库使用

远程仓库是托管在互联网或其他网络上项目的版本库,便于多人协作开发项目.管理远程仓库主要是添加远程仓库,删除无效远程仓库,管理远程分支等操作

###### 查看远程仓库

- 指令git remote
  - 会列出指定远程服务器的简写
  - origin是克隆的仓库服务器默认名字
  - 可选-v可以查看origin的url

###### 添加远程仓库

- 指令git clone
  - 自行添加远程仓库,并且以origin为简写
- 指令git remote add<shortname><url>
  - 自定义添加远程仓库,区别在于可以自行定义简写内容
  - 添加后master分支可以在本地被访问并合并到某分支中

###### 远程仓库中抓取和拉取

- 指令git fetch <remote>
  - 访问远程仓库并拉取所有项目中没有的数据,
  - 执行后获得远程仓库中所有分支引用,可以随时合并和查看

#### 分支

分支是版本控制系统里广泛支持的功能,分支可以让开发从主线上分离开,避免影响主线开发

###### 分支简介

- 数据保存
  - Git保存的是项目一些列不同时刻的快照
- 提交对象
  - 提交操作时Git会保存提交对象
  - 提交对象中含有指向暂存内容快照的指针,指向父对象指针和作者信息
  - 多个分支合并产生的提交对象有多个父对象